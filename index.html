<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tal√°ld ki az aj√°nd√©kom</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #ffffff;
      color: #000000;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      padding: 16px;
      box-sizing: border-box;
      transition: background-color 0.3s, color 0.3s;
    }

    body.dark-mode {
      background-color: #121212;
      color: #eaeaea;
    }

    .game {
      background-color: #f0f0f0;
      padding: 24px 20px 28px;
      border-radius: 16px;
      width: 100%;
      max-width: 380px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
      text-align: center;
      box-sizing: border-box;
    }

    body.dark-mode .game {
      background-color: #1c1c1c;
    }

    h2 { margin-bottom: 20px; }

    input, button {
      width: 100%;
      padding: 14px;
      margin-top: 12px;
      border-radius: 12px;
      font-size: 16px;
      box-sizing: border-box;
    }

    button {
      border: none;
      background: linear-gradient(135deg, #4facfe, #00f2fe);
      font-weight: bold;
      cursor: pointer;
    }

    #hintContainer { margin-top: 16px; font-style: italic; }
    #message { font-size: 1.5rem; margin-top: 16px; display: none; }

/* WIN ANIMATION */
@keyframes winPop {
  0% { transform: scale(0.5); opacity: 0; }
  60% { transform: scale(1.1); opacity: 1; }
  100% { transform: scale(1); }
}

@keyframes glow {
  0% { box-shadow: 0 0 0 rgba(255,255,255,0); }
  50% { box-shadow: 0 0 35px rgba(255,255,255,0.8); }
  100% { box-shadow: 0 0 0 rgba(255,255,255,0); }
}

.win-animate {
  animation: winPop 0.6s ease-out, glow 1.5s ease-in-out;
}

/* FADE OUT */
.fade-out {
  opacity: 0;
  transition: opacity 2s ease;
}

/* FADE IN */
.fade-in {
  opacity: 0;
  animation: fadeInSlow 3s ease forwards;
}

@keyframes fadeInSlow {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* CONFETTI */

/* SNOW */
.snowflake {
  position: fixed;
  top: -10px;
  color: white;
  font-size: 12px;
  user-select: none;
  pointer-events: none;
  animation: snowFall linear forwards;
  z-index: 0;
}

@keyframes snowFall {
  to {
    transform: translateY(110vh);
    opacity: 0.3;
  }
}

/* CONFETTI */
.confetti {
  position: fixed;
  top: -10px;
  width: 10px;
  height: 10px;
  background-color: red;
  animation: fall 3s linear forwards;
  z-index: 9999;
}

@keyframes fall {
  to {
    transform: translateY(110vh) rotate(720deg);
    opacity: 0;
  }
}

    #timer { font-size: 2.5rem; margin-top: 18px; display: none; }
    #winImage { width: 100%; margin-top: 18px; display: none; }

    #winVideo {
      width: 100%;
      aspect-ratio: 9 / 16;
      margin-top: 18px;
      border-radius: 12px;
      display: none;
      border: none;
    }
  </style>
</head>
<body>

<div class="game">
  <h2 id="title"></h2>
  <input id="guessInput" placeholder="Tippelj ide" onkeydown="handleEnter(event)">
  <button id="guessButton" onclick="checkGuess()">Tippel√©s</button>
  <button id="toggleDarkMode" onclick="toggleDarkMode()">Dark Mode</button>

  <div id="hintContainer"><b>Hint:</b> <span id="hint"></span></div>
  <div id="message"></div>
  <div id="timer"></div>
  <div id="endScreen" class="fade-in" style="display:none;font-size:2rem;margin-top:24px;">üéÅ<br>K√∂sz√∂n√∂m, hogy v√©gigj√°tszottad!<br>üíô</div>

  <img id="winImage" alt="Gy≈ëzelem">
  <iframe id="winVideo" loading="lazy" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  <button id="volumeToggle" style="display:none" onclick="toggleVolume()">üîá Hang be</button>
</div>

<script>
// J√ÅT√âK ADATOK
const games = [
  {
    answers: ["ferrari", "lewis hamilton", "f1"],
    hints: ["shitbox", "0 gy≈ëzelem", "legjobb pil√≥ta szerinted"],
    image: "https://upload.wikimedia.org/wikipedia/commons/3/3e/Lewis_Hamilton_2022.jpg",
    video: "https://www.youtube.com/embed/kl88LBlGyx4?playsinline=1&rel=0",
    showMedia: true
  },
  {
    answers: ["√°ram programoz√°s", "√°ramk√∂r", "circuit"],
    hints: ["R√©gen sokat j√°tszott√°l ezzel", "Nemr√©g besz√©lt√ºnk err≈ël", "√Åramk√∂r"],
    showMedia: false
  }
];

// √ÅLLAPOT
let currentGame = Number(localStorage.getItem("currentGame")) || 0;
let attempts = 0;
const unlockDate = new Date("2026-01-09T00:00:00");
let countdownInterval = null;

// ELEMEK
const input = document.getElementById("guessInput");
const button = document.getElementById("guessButton");
const hint = document.getElementById("hint");
const message = document.getElementById("message");
const timer = document.getElementById("timer");
const winImage = document.getElementById("winImage");
const winVideo = document.getElementById("winVideo");
const volumeToggle = document.getElementById("volumeToggle");
let isMuted = true;

// C√çM
const titleEl = document.getElementById("title");
titleEl.textContent = currentGame === 0 ? "Tal√°ld ki az aj√°nd√©kom!" : "M√°sodik kih√≠v√°s";

// F≈ê LOGIKA
function checkGuess() {
  const guess = input.value.toLowerCase().trim();

  if (games[currentGame].answers.includes(guess)) {
    // MOBIL VIBR√ÅCI√ì NYER√âSKOR
    if (navigator.vibrate) {
      navigator.vibrate([200, 100, 200]);
    }
    launchConfetti();
    message.textContent = "Eltal√°ltad!";
    message.classList.remove("win-animate");
    void message.offsetWidth; // restart animation
    message.classList.add("win-animate");
    message.style.display = "block";

    // C√çM √âS HINT ELREJT√âSE NYER√âSKOR
    document.getElementById("title").style.display = "none";
    document.getElementById("hintContainer").style.display = "none";

    input.style.display = "none";
    button.style.display = "none";
    hint.textContent = "";

    if (games[currentGame].showMedia) {
      winImage.src = games[currentGame].image;
      winImage.style.display = "block";
      winImage.classList.remove("win-animate");
      void winImage.offsetWidth;
      winImage.classList.add("win-animate");

      winVideo.src = games[currentGame].video + "&autoplay=1&mute=1";
      isMuted = true;
      volumeToggle.textContent = "üîä Hang be";
      volumeToggle.style.display = "block";
      winVideo.style.display = "block";
      winVideo.classList.remove("win-animate");
      void winVideo.offsetWidth;
      winVideo.classList.add("win-animate");
    }

    if (currentGame === 0) {
      // 1 perc ut√°n fade out, majd timer
      setTimeout(() => {
        message.classList.add("fade-out");
        if (games[currentGame].showMedia) {
          winImage.classList.add("fade-out");
          winVideo.classList.add("fade-out");
          volumeToggle.classList.add("fade-out");
        }
      }, 60000);

      setTimeout(startCountdown, 62000);
    } else {
      // M√ÅSODIK J√ÅT√âK UT√ÅN: V√âGE K√âPERNY≈ê
      setTimeout(() => {
        message.classList.add("fade-out");
        const end = document.getElementById("endScreen");
        end.style.display = "block";
        end.classList.remove("fade-in");
        void end.offsetWidth;
        end.classList.add("fade-in");
      }, 60000);

      // MINDEN LEZ√ÅR√ÅSA
      input.disabled = true;
      button.disabled = true;
      localStorage.setItem("gameFinished", "true");
    }

  } else if (attempts < games[currentGame].hints.length) {
    hint.textContent = games[currentGame].hints[attempts];
    attempts++;
  }

  input.value = "";
}

function startCountdown() {
  // TIMER ALATT SE LEGYEN C√çM √âS HINT
  document.getElementById("title").style.display = "none";
  document.getElementById("hintContainer").style.display = "none";
  message.style.display = "none";
  timer.style.display = "block";

  if (countdownInterval) clearInterval(countdownInterval);
  updateCountdown();
  countdownInterval = setInterval(updateCountdown, 1000);
}

function updateCountdown() {
  const diff = unlockDate - new Date();

  if (diff <= 0) {
    clearInterval(countdownInterval);
    localStorage.setItem("currentGame", "1");
    location.reload();
    return;
  }

  const d = Math.floor(diff / 86400000);
  const h = Math.floor(diff / 3600000) % 24;
  const m = Math.floor(diff / 60000) % 60;
  const s = Math.floor(diff / 1000) % 60;

  timer.textContent = `${d} nap ${h} √≥ra ${m} perc ${s} mp`;
}

function handleEnter(e) {
  if (e.key === "Enter") {
    checkGuess();
  }
}

function toggleDarkMode() {
  document.body.classList.toggle("dark-mode");
}

function toggleVolume() {
  if (!winVideo.src) return;
  isMuted = !isMuted;
  const base = games[currentGame].video;
  winVideo.src = base + `&autoplay=1&mute=${isMuted ? 1 : 0}`;
  volumeToggle.textContent = isMuted ? "üîä Hang be" : "üîá Hang ki";
}

// ADMIN CHEAT (Ctrl + Shift + R)
document.addEventListener("keydown", (e) => {
  if (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === "r") {
    localStorage.clear();
    location.reload();
  }
});
function launchConfetti() {
  const colors = ["#ff0000", "#00ff00", "#ffffff", "#ffcc00"]; // kar√°csonyi
  for (let i = 0; i < 40; i++) {
    const conf = document.createElement("div");
    conf.className = "confetti";
    conf.style.left = Math.random() * 100 + "vw";
    conf.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
    conf.style.animationDuration = 2 + Math.random() * 2 + "s";
    document.body.appendChild(conf);
    setTimeout(() => conf.remove(), 4000);
  }
}

// HULL√ì H√ì IND√çT√ÅSA
function startSnow() {
  setInterval(() => {
    const snow = document.createElement("div");
    snow.className = "snowflake";
    snow.textContent = "‚ùÑ";
    snow.style.left = Math.random() * 100 + "vw";
    snow.style.fontSize = 10 + Math.random() * 10 + "px";
    snow.style.animationDuration = 6 + Math.random() * 6 + "s";
    document.body.appendChild(snow);

    setTimeout(() => snow.remove(), 12000);
  }, 300);
}

startSnow();

</script>

</body>
</html>
